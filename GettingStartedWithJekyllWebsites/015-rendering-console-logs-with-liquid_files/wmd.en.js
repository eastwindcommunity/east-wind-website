"use strict";var Markdown={};!function(){function e(e){return e}function t(){return!1}function n(){}function i(){}n.prototype={"chain":function(t,n){var i=this[t];if(!i)throw new Error("unknown hook "+t);this[t]=i===e?n:function(){var e=Array.prototype.slice.call(arguments,0);return e[0]=i.apply(null,e),n.apply(null,e)}},"set":function(e,t){if(!this[e])throw new Error("unknown hook "+e);this[e]=t},"addNoop":function(t){this[t]=e},"addFalse":function(e){this[e]=t}},Markdown.HookCollection=n,i.prototype={"set":function(e,t){this["s_"+e]=t},"get":function(e){return this["s_"+e]}},Markdown.Converter=function(){function e(e){return e=e.replace(/^[ ]{0,3}\[([^\[\]]+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?(?=\s|$)[ \t]*\n?[ \t]*((\n*)["(](.+?)[")][ \t]*)?(?:\n+)/gm,function(e,t,n,i,r,a){return t=t.toLowerCase(),O.set(t,S(n)),r?i:(a&&D.set(t,a.replace(/"/g,"&quot;")),"")})}function t(e){return e=e.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,r),e=e.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\b[^\r]*?.*<\/\2>[ \t]*(?=\n+)\n)/gm,r),e=e.replace(/\n[ ]{0,3}((<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,r),e=e.replace(/\n\n[ ]{0,3}(<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>[ \t]*(?=\n{2,}))/g,r),e=e.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,r)}function r(e,t){var n=t;return n=n.replace(/^\n+/,""),n=n.replace(/\n+$/g,""),n="\n\n~K"+(q.push(n)-1)+"K\n\n"}function a(e,n){e=L.preBlockGamut(e,j),e=h(e);var i="<hr />\n";return e=e.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,i),e=e.replace(/^[ ]{0,2}([ ]?-[ ]?){3,}[ \t]*$/gm,i),e=e.replace(/^[ ]{0,2}([ ]?_[ ]?){3,}[ \t]*$/gm,i),e=p(e),e=m(e),e=x(e),e=L.postBlockGamut(e,j),e=t(e),e=k(e,n)}function o(e){return e=L.preSpanGamut(e),e=b(e),e=s(e),e=$(e),e=l(e),e=c(e),e=E(e),e=e.replace(/~P/g,"://"),e=S(e),e=y(e),e=e.replace(/  +\n/g," <br>\n"),e=L.postSpanGamut(e)}function s(e){var t=/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>)/gi;return e=e.replace(t,function(e){var t=e.replace(/(.)<\/?code>(?=.)/g,"$1`");return t=M(t,"!"==e.charAt(1)?"\\`*_/":"\\`*_")})}function c(e){return e=e.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,u),e=e.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?((?:\([^)]*\)|[^()\s])*?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,u),e=e.replace(/(\[([^\[\]]+)\])()()()()()/g,u)}function u(e,t,n,i,r,a,o,s){void 0==s&&(s="");var c=t,u=n.replace(/:\/\//g,"~P"),l=i.toLowerCase(),f=r,h=s;if(""==f)if(""==l&&(l=u.toLowerCase().replace(/ ?\n/g," ")),f="#"+l,void 0!=O.get(l))f=O.get(l),void 0!=D.get(l)&&(h=D.get(l));else{if(!(c.search(/\(\s*\)$/m)>-1))return c;f=""}f=R(f),f=M(f,"*_");var p='<a href="'+f+'"';return""!=h&&(h=d(h),h=M(h,"*_"),p+=' title="'+h+'"'),p+=">"+u+"</a>"}function l(e){return e=e.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,f),e=e.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,f)}function d(e){return e.replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")}function f(e,t,n,i,r,a,o,s){var c=t,u=n,l=i.toLowerCase(),f=r,h=s;if(h||(h=""),""==f){if(""==l&&(l=u.toLowerCase().replace(/ ?\n/g," ")),f="#"+l,void 0==O.get(l))return c;f=O.get(l),void 0!=D.get(l)&&(h=D.get(l))}u=M(d(u),"*_[]()"),f=M(f,"*_");var p='<img src="'+f+'" alt="'+u+'"';return h=d(h),h=M(h,"*_"),p+=' title="'+h+'"',p+=" />"}function h(e){return e=e.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(e,t){return"<h1>"+o(t)+"</h1>\n\n"}),e=e.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(e,t){return"<h2>"+o(t)+"</h2>\n\n"}),e=e.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(e,t,n){var i=t.length;return"<h"+i+">"+o(n)+"</h"+i+">\n\n"})}function p(e,t){e+="~0";var n=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;return P?e=e.replace(n,function(e,n,i){var r=n,a=i.search(/[*+-]/g)>-1?"ul":"ol",o=g(r,a,t);return o=o.replace(/\s+$/,""),o="<"+a+">"+o+"</"+a+">\n"}):(n=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g,e=e.replace(n,function(e,t,n,i){var r=t,a=n,o=i.search(/[*+-]/g)>-1?"ul":"ol",s=g(a,o);return s=r+"<"+o+">\n"+s+"</"+o+">\n"})),e=e.replace(/~0/,"")}function g(e,t,n){P++,e=e.replace(/\n{2,}$/,"\n"),e+="~0";var i=U[t],r=new RegExp("(^[ \\t]*)("+i+")[ \\t]+([^\\r]+?(\\n+))(?=(~0|\\1("+i+")[ \\t]+))","gm"),s=!1;return e=e.replace(r,function(e,t,i,r){var c=r,u=/\n\n$/.test(c),l=u||c.search(/\n{2,}/)>-1;return l||s?c=a(I(c),!0):(c=p(I(c),!0),c=c.replace(/\n$/,""),n||(c=o(c))),s=u,"<li>"+c+"</li>\n"}),e=e.replace(/~0/g,""),P--,e}function m(e){return e+="~0",e=e.replace(/(?:\n\n|^\n?)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,function(e,t,n){var i=t,r=n;return i=w(I(i)),i=A(i),i=i.replace(/^\n+/g,""),i=i.replace(/\n+$/g,""),i="<pre><code>"+i+"\n</code></pre>","\n\n"+i+"\n\n"+r}),e=e.replace(/~0/,"")}function v(e){return e=e.replace(/(^\n+|\n+$)/g,""),"\n\n~K"+(q.push(e)-1)+"K\n\n"}function b(e){return e=e.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(e,t,n,i){var r=i;return r=r.replace(/^([ \t]*)/g,""),r=r.replace(/[ \t]*$/g,""),r=w(r),r=r.replace(/:\/\//g,"~P"),t+"<code>"+r+"</code>"})}function w(e){return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=M(e,"*_{}[]\\",!1)}function y(e){return e=e.replace(/([\W_]|^)(\*\*|__)(?=\S)([^\r]*?\S[\*_]*)\2([\W_]|$)/g,"$1<strong>$3</strong>$4"),e=e.replace(/([\W_]|^)(\*|_)(?=\S)([^\r\*_]*?\S)\2([\W_]|$)/g,"$1<em>$3</em>$4")}function x(e){return e=e.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(e,t){var n=t;return n=n.replace(/^[ \t]*>[ \t]?/gm,"~0"),n=n.replace(/~0/g,""),n=n.replace(/^[ \t]+$/gm,""),n=a(n),n=n.replace(/(^|\n)/g,"$1  "),n=n.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(e,t){var n=t;return n=n.replace(/^  /gm,"~0"),n=n.replace(/~0/g,"")}),v("<blockquote>\n"+n+"\n</blockquote>")})}function k(e,t){e=e.replace(/^\n+/g,""),e=e.replace(/\n+$/g,"");for(var n=e.split(/\n{2,}/g),i=[],r=/~K(\d+)K/,a=n.length,s=0;a>s;s++){var c=n[s];r.test(c)?i.push(c):/\S/.test(c)&&(c=o(c),c=c.replace(/^([ \t]*)/g,"<p>"),c+="</p>",i.push(c))}if(!t){a=i.length;for(var s=0;a>s;s++)for(var u=!0;u;)u=!1,i[s]=i[s].replace(/~K(\d+)K/g,function(e,t){return u=!0,q[t]})}return i.join("\n\n")}function S(e){return e=e.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;"),e=e.replace(/<(?![a-z\/?!]|~D)/gi,"&lt;")}function $(e){return e=e.replace(/\\(\\)/g,_),e=e.replace(/\\([`*_{}\[\]()>#+-.!])/g,_)}function C(e,t,n,i){if(t)return e;if(")"!==i.charAt(i.length-1))return"<"+n+i+">";for(var r=i.match(/[()]/g),a=0,o=0;o<r.length;o++)"("===r[o]?0>=a?a=1:a++:a--;var s="";if(0>a){var c=new RegExp("\\){1,"+-a+"}$");i=i.replace(c,function(e){return s=e,""})}if(s){var u=i.charAt(i.length-1);N.test(u)||(s=u+s,i=i.substr(0,i.length-1))}return"<"+n+i+">"+s}function E(e){e=e.replace(B,C);var t=function(e,t){return'<a href="'+t+'">'+L.plainLinkText(t)+"</a>"};return e=e.replace(/<((https?|ftp):[^'">\s]+)>/gi,t)}function T(e){return e=e.replace(/~E(\d+)E/g,function(e,t){var n=parseInt(t);return String.fromCharCode(n)})}function I(e){return e=e.replace(/^(\t|[ ]{1,4})/gm,"~0"),e=e.replace(/~0/g,"")}function A(e){if(!/\t/.test(e))return e;var t,n=["    ","   ","  "," "],i=0;return e.replace(/[\n\t]/g,function(e,r){return"\n"===e?(i=r+1,e):(t=(r-i)%4,i=r+1,n[t])})}function R(e){if(!e)return"";var t=e.length;return e.replace(V,function(n,i){return"~D"==n?"%24":":"!=n||i!=t-1&&!/[0-9\/]/.test(e.charAt(i+1))?"%"+n.charCodeAt(0).toString(16):":"})}function M(e,t,n){var i="(["+t.replace(/([\[\]\\])/g,"\\$1")+"])";n&&(i="\\\\"+i);var r=new RegExp(i,"g");return e=e.replace(r,_)}function _(e,t){var n=t.charCodeAt(0);return"~E"+n+"E"}var L=this.hooks=new n;L.addNoop("plainLinkText"),L.addNoop("preConversion"),L.addNoop("postNormalization"),L.addNoop("preBlockGamut"),L.addNoop("postBlockGamut"),L.addNoop("preSpanGamut"),L.addNoop("postSpanGamut"),L.addNoop("postConversion");var O,D,q,P;this.makeHtml=function(n){if(O)throw new Error("Recursive call to converter.makeHtml");return O=new i,D=new i,q=[],P=0,n=L.preConversion(n),n=n.replace(/~/g,"~T"),n=n.replace(/\$/g,"~D"),n=n.replace(/\r\n/g,"\n"),n=n.replace(/\r/g,"\n"),n="\n\n"+n+"\n\n",n=A(n),n=n.replace(/^[ \t]+$/gm,""),n=L.postNormalization(n),n=t(n),n=e(n),n=a(n),n=T(n),n=n.replace(/~D/g,"$$"),n=n.replace(/~T/g,"~"),n=L.postConversion(n),q=D=O=null,n};var j=function(e){return a(e)},U={"ol":"\\d+[.]","ul":"[*+-]"},F="[-A-Z0-9+&@#/%?=~_|[\\]()!:,.;]",H="[-A-Z0-9+&@#/%=~_|[\\])]",B=new RegExp('(="|<)?\\b(https?|ftp)(://'+F+"*"+H+")(?=$|\\W)","gi"),N=new RegExp(H,"i"),V=/(?:["'*()[\]:]|~D)/g}}(),function(){function e(){}function t(e){this.buttonBar=d.getElementById("wmd-button-bar"+e),this.preview=d.getElementById("wmd-preview"+e),this.input=d.getElementById("wmd-input"+e)}function n(e,t){var n,r,a,o=this,s=[],u=0,l="none",d=function(e,t){l!=e&&(l=e,t||h()),g.isIE&&"moving"==l?a=null:r=setTimeout(f,1)},f=function(e){a=new i(t,e),r=void 0};this.setCommandMode=function(){l="command",h(),r=setTimeout(f,0)},this.canUndo=function(){return u>1},this.canRedo=function(){return s[u+1]?!0:!1},this.undo=function(){o.canUndo()&&(n?(n.restore(),n=null):(s[u]=new i(t),s[--u].restore(),e&&e())),l="none",t.input.focus(),f()},this.redo=function(){o.canRedo()&&(s[++u].restore(),e&&e()),l="none",t.input.focus(),f()};var h=function(){var r=a||new i(t);return r?"moving"==l?(n||(n=r),void 0):(n&&(s[u-1].text!=n.text&&(s[u++]=n),n=null),s[u++]=r,s[u+1]=null,e&&e(),void 0):!1},p=function(e){var t=!1;if((e.ctrlKey||e.metaKey)&&!e.altKey){var n=e.charCode||e.keyCode,i=String.fromCharCode(n);switch(i.toLowerCase()){case"y":o.redo(),t=!0;break;case"z":e.shiftKey?o.redo():o.undo(),t=!0}}return t?(e.preventDefault&&e.preventDefault(),window.event&&(window.event.returnValue=!1),void 0):void 0},m=function(e){if(!e.ctrlKey&&!e.metaKey){var t=e.keyCode;t>=33&&40>=t||t>=63232&&63235>=t?d("moving"):8==t||46==t||127==t?d("deleting"):13==t?d("newlines"):27==t?d("escape"):(16>t||t>20)&&91!=t&&d("typing")}},v=function(){c.addEvent(t.input,"keypress",function(e){!e.ctrlKey&&!e.metaKey||e.altKey||89!=e.keyCode&&90!=e.keyCode||e.preventDefault()});var e=function(){(g.isIE||a&&a.text!=t.input.value)&&void 0==r&&(l="paste",h(),f())};c.addEvent(t.input,"keydown",p),c.addEvent(t.input,"keydown",m),c.addEvent(t.input,"mousedown",function(){d("moving")}),t.input.onpaste=e,t.input.ondrop=e},b=function(){v(),f(!0),h()};b()}function i(t,n){var i=this,r=t.input;this.init=function(){c.isVisible(r)&&(n||!d.activeElement||d.activeElement===r)&&(this.setInputAreaSelectionStartEnd(),this.scrollTop=r.scrollTop,(!this.text&&r.selectionStart||0===r.selectionStart)&&(this.text=r.value))},this.setInputAreaSelection=function(){if(c.isVisible(r))if(void 0===r.selectionStart||g.isOpera){if(d.selection){if(d.activeElement&&d.activeElement!==r)return;r.focus();var e=r.createTextRange();e.moveStart("character",-r.value.length),e.moveEnd("character",-r.value.length),e.moveEnd("character",i.end),e.moveStart("character",i.start),e.select()}}else r.focus(),r.selectionStart=i.start,r.selectionEnd=i.end,r.scrollTop=i.scrollTop},this.setInputAreaSelectionStartEnd=function(){if(t.ieCachedRange||!r.selectionStart&&0!==r.selectionStart){if(d.selection){i.text=c.fixEolChars(r.value);var e=t.ieCachedRange||d.selection.createRange(),n=c.fixEolChars(e.text),a="",o=a+n+a;e.text=o;var s=c.fixEolChars(r.value);e.moveStart("character",-o.length),e.text=n,i.start=s.indexOf(a),i.end=s.lastIndexOf(a)-a.length;var u=i.text.length-c.fixEolChars(r.value).length;if(u){for(e.moveStart("character",-n.length);u--;)n+="\n",i.end+=1;e.text=n}t.ieCachedRange&&(i.scrollTop=t.ieCachedScrollTop),t.ieCachedRange=null,this.setInputAreaSelection()}}else i.start=r.selectionStart,i.end=r.selectionEnd},this.restore=function(){void 0!=i.text&&i.text!=r.value&&(r.value=i.text),this.setInputAreaSelection(),r.scrollTop=i.scrollTop},this.getChunks=function(){var t=new e;return t.before=c.fixEolChars(i.text.substring(0,i.start)),t.startTag="",t.selection=c.fixEolChars(i.text.substring(i.start,i.end)),t.endTag="",t.after=c.fixEolChars(i.text.substring(i.end)),t.scrollTop=i.scrollTop,t},this.setChunks=function(e){e.before=e.before+e.startTag,e.after=e.endTag+e.after,this.start=e.before.length,this.end=e.before.length+e.selection.length,this.text=e.before+e.selection+e.after,this.scrollTop=e.scrollTop},this.init()}function r(e,t,n){var i,r,a,o=3e3,s="delayed",l=function(e,t){c.addEvent(e,"input",t),e.onpaste=t,e.ondrop=t,c.addEvent(e,"keypress",t),c.addEvent(e,"keydown",t)},f=function(){var e=0;return window.innerHeight?e=window.pageYOffset:d.documentElement&&d.documentElement.scrollTop?e=d.documentElement.scrollTop:d.body&&(e=d.body.scrollTop),e},h=function(){if(t.preview){var n=t.input.value;if(!n||n!=a){a=n;var i=(new Date).getTime();n=e.makeHtml(n);var o=(new Date).getTime();r=o-i,S(n)}}},p=function(){if(i&&(clearTimeout(i),i=void 0),"manual"!==s){var e=0;"delayed"===s&&(e=r),e>o&&(e=o),i=setTimeout(h,e)}},m=function(e){return e.scrollHeight<=e.clientHeight?1:e.scrollTop/(e.scrollHeight-e.clientHeight)},v=function(){t.preview&&(t.preview.scrollTop=(t.preview.scrollHeight-t.preview.clientHeight)*m(t.preview))};this.refresh=function(e){e?(a="",h()):p()},this.processingTime=function(){return r};var b,w=!0,y=function(e){var n=t.preview,i=n.parentNode,r=n.nextSibling;i.removeChild(n),n.innerHTML=e,r?i.insertBefore(n,r):i.appendChild(n)},x=function(e){t.preview.innerHTML=e},k=function(e){if(b)return b(e);try{x(e),b=x}catch(t){b=y,b(e)}},S=function(e){var i=u.getTop(t.input)-f();if(t.preview&&(k(e),n()),v(),w)return w=!1,void 0;var r=u.getTop(t.input)-f();g.isIE?setTimeout(function(){window.scrollBy(0,r-i)},0):window.scrollBy(0,r-i)},$=function(){l(t.input,p),h(),t.preview&&(t.preview.scrollTop=0)};$()}function a(e,t,n,r,a,o,s){function u(e){if(v.focus(),e.textOp){n&&n.setCommandMode();var a=new i(t);if(!a)return;var o=a.getChunks(),s=function(){v.focus(),o&&a.setChunks(o),a.restore(),r.refresh()},c=e.textOp(o,s);c||s()}e.execute&&e.execute(n)}function l(e,n){var i="0px",r="-20px",a="-40px",o=e.getElementsByTagName("span")[0];n?(o.style.backgroundPosition=e.XShift+" "+i,e.onmouseover=function(){o.style.backgroundPosition=this.XShift+" "+a},e.onmouseout=function(){o.style.backgroundPosition=this.XShift+" "+i},g.isIE&&(e.onmousedown=function(){d.activeElement&&d.activeElement!==t.input||(t.ieCachedRange=document.selection.createRange(),t.ieCachedScrollTop=t.input.scrollTop)}),e.isHelp||(e.onclick=function(){return this.onmouseout&&this.onmouseout(),u(this),!1})):(o.style.backgroundPosition=e.XShift+" "+r,e.onmouseover=e.onmouseout=e.onclick=function(){})}function f(e){return"string"==typeof e&&(e=a[e]),function(){e.apply(a,arguments)}}function p(){var n=t.buttonBar,i=document.createElement("ul");i.id="wmd-button-row"+e,i.className="wmd-button-row",i=n.appendChild(i);var r=0,a=function(t,n,a,o){var s=document.createElement("li");s.className="wmd-button",s.style.left=r+"px",r+=25;var c=document.createElement("span");return s.id=t+e,s.appendChild(c),s.title=n,s.XShift=a,o&&(s.textOp=o),l(s,!0),i.appendChild(s),s},c=function(t){var n=document.createElement("li");n.className="wmd-spacer wmd-spacer"+t,n.id="wmd-spacer"+t+e,i.appendChild(n),r+=25};b.bold=a("wmd-bold-button",s("bold"),"0px",f("doBold")),b.italic=a("wmd-italic-button",s("italic"),"-20px",f("doItalic")),c(1),b.link=a("wmd-link-button",s("link"),"-40px",f(function(e,t){return this.doLinkOrImage(e,t,!1)})),b.quote=a("wmd-quote-button",s("quote"),"-60px",f("doBlockquote")),b.code=a("wmd-code-button",s("code"),"-80px",f("doCode")),b.image=a("wmd-image-button",s("image"),"-100px",f(function(e,t){return this.doLinkOrImage(e,t,!0)})),c(2),b.olist=a("wmd-olist-button",s("olist"),"-120px",f(function(e,t){this.doList(e,t,!0)})),b.ulist=a("wmd-ulist-button",s("ulist"),"-140px",f(function(e,t){this.doList(e,t,!1)})),b.heading=a("wmd-heading-button",s("heading"),"-160px",f("doHeading")),b.hr=a("wmd-hr-button",s("hr"),"-180px",f("doHorizontalRule")),c(3),b.undo=a("wmd-undo-button",s("undo"),"-200px",null),b.undo.execute=function(e){e&&e.undo()};var u=/win/.test(h.platform.toLowerCase())?s("redo"):s("redomac");if(b.redo=a("wmd-redo-button",u,"-220px",null),b.redo.execute=function(e){e&&e.redo()},o){var d=document.createElement("li"),p=document.createElement("span");d.appendChild(p),d.className="wmd-button wmd-help-button",d.id="wmd-help-button"+e,d.XShift="-240px",d.isHelp=!0,d.style.right="0px",d.title=s("help"),d.onclick=o.handler,l(d,!0),i.appendChild(d),b.help=d}m()}function m(){n&&(l(b.undo,n.canUndo()),l(b.redo,n.canRedo()))}var v=t.input,b={};p();var w="keydown";g.isOpera&&(w="keypress"),c.addEvent(v,w,function(e){if((e.ctrlKey||e.metaKey)&&!e.altKey&&!e.shiftKey){var t=e.charCode||e.keyCode,n=String.fromCharCode(t).toLowerCase();switch(n){case"b":u(b.bold);break;case"i":u(b.italic);break;case"l":u(b.link);break;case"q":u(b.quote);break;case"k":u(b.code);break;case"g":u(b.image);break;case"o":u(b.olist);break;case"u":u(b.ulist);break;case"h":u(b.heading);break;case"r":u(b.hr);break;case"y":u(b.redo);break;case"z":e.shiftKey?u(b.redo):u(b.undo);break;default:return}e.preventDefault&&e.preventDefault(),window.event&&(window.event.returnValue=!1)}}),c.addEvent(v,"keyup",function(e){if(e.shiftKey&&!e.ctrlKey&&!e.metaKey){var t=e.charCode||e.keyCode;if(13===t){var n={};n.textOp=f("doAutoindent"),u(n)}}}),g.isIE&&c.addEvent(v,"keydown",function(e){var t=e.keyCode;return 27===t?!1:void 0}),this.setUndoRedoButtonStates=m}function o(e,t){this.hooks=e,this.getString=t}function s(e){return e.replace(/^\s*(.*?)(?:\s+"(.+)")?\s*$/,function(e,t,n){return t=t.replace(/\?.*$/,function(e){return e.replace(/\+/g," ")}),t=decodeURIComponent(t),t=encodeURI(t).replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29"),t=t.replace(/\?.*$/,function(e){return e.replace(/\+/g,"%2b")}),n&&(n=n.trim?n.trim():n.replace(/^\s*/,"").replace(/\s*$/,""),n=n.replace(/"/g,"quot;").replace(/\(/g,"&#40;").replace(/\)/g,"&#41;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),n?t+' "'+n+'"':t})}var c={},u={},l={},d=window.document,f=window.RegExp,h=window.navigator,p={"lineLength":72},g={"isIE":/msie/.test(h.userAgent.toLowerCase()),"isIE_5or6":/msie 6/.test(h.userAgent.toLowerCase())||/msie 5/.test(h.userAgent.toLowerCase()),"isOpera":/opera/.test(h.userAgent.toLowerCase())},m={"bold":"Strong <strong> Ctrl+B","boldexample":"strong text","italic":"Emphasis <em> Ctrl+I","italicexample":"emphasized text","link":"Hyperlink <a> Ctrl+L","linkdescription":"enter link description here","linkdialog":'<p><b>Insert Hyperlink</b></p><p>http://example.com/ "optional title"</p>',"quote":"Blockquote <blockquote> Ctrl+Q","quoteexample":"Blockquote","code":"Code Sample <pre><code> Ctrl+K","codeexample":"enter code here","image":"Image <img> Ctrl+G","imagedescription":"enter image description here","imagedialog":'<p><b>Insert Image</b></p><p>http://example.com/images/diagram.jpg "optional title"<br><br>'+function(e){return"Need "+e.startAnchor+"free image hosting?"+e.endAnchor}({"startAnchor":"<a href='http://www.google.com/search?q=free+image+hosting' target='_blank'>","endAnchor":"</a>"})+"</p>","olist":"Numbered List <ol> Ctrl+O","ulist":"Bulleted List <ul> Ctrl+U","litem":"List item","heading":"Heading <h1>/<h2> Ctrl+H","headingexample":"Heading","hr":"Horizontal Rule <hr> Ctrl+R","undo":"Undo - Ctrl+Z","redo":"Redo - Ctrl+Y","redomac":"Redo - Ctrl+Shift+Z","help":"Markdown Editing Help"},v="http://",b="http://";Markdown.Editor=function(e,i,s){s=s||{},"function"==typeof s.handler&&(s={"helpButton":s}),s.strings=s.strings||{},s.helpButton&&(s.strings.help=s.strings.help||s.helpButton.title);var c=function(e){return s.strings[e]||m[e]};i=i||"";var u=this.hooks=new Markdown.HookCollection;u.addNoop("onPreviewRefresh"),u.addNoop("postBlockquoteCreation"),u.addFalse("insertImageDialog"),this.getConverter=function(){return e};var l,f=this;this.run=function(){if(!l){l=new t(i);var h,p,g=new o(u,c),m=new r(e,l,function(){u.onPreviewRefresh()});/\?noundo/.test(d.location.href)||(h=new n(function(){m.refresh(),p&&p.setUndoRedoButtonStates()},l),this.textOperation=function(e){h.setCommandMode(),e(),f.refreshPreview()}),p=new a(i,l,h,m,g,s.helpButton,c),p.setUndoRedoButtonStates();var v=f.refreshPreview=function(){m.refresh(!0)};v()}}},e.prototype.findTags=function(e,t){var n,i=this;e&&(n=c.extendRegExp(e,"","$"),this.before=this.before.replace(n,function(e){return i.startTag=i.startTag+e,""}),n=c.extendRegExp(e,"^",""),this.selection=this.selection.replace(n,function(e){return i.startTag=i.startTag+e,""})),t&&(n=c.extendRegExp(t,"","$"),this.selection=this.selection.replace(n,function(e){return i.endTag=e+i.endTag,""}),n=c.extendRegExp(t,"^",""),this.after=this.after.replace(n,function(e){return i.endTag=e+i.endTag,""}))},e.prototype.trimWhitespace=function(e){var t,n,i=this;e?t=n="":(t=function(e){return i.before+=e,""},n=function(e){return i.after=e+i.after,""}),this.selection=this.selection.replace(/^(\s*)/,t).replace(/(\s*)$/,n)},e.prototype.skipLines=function(e,t,n){void 0===e&&(e=1),void 0===t&&(t=1),e++,t++;var i,r;if(navigator.userAgent.match(/Chrome/)&&"X".match(/()./),this.selection=this.selection.replace(/(^\n*)/,""),this.startTag=this.startTag+f.$1,this.selection=this.selection.replace(/(\n*$)/,""),this.endTag=this.endTag+f.$1,this.startTag=this.startTag.replace(/(^\n*)/,""),this.before=this.before+f.$1,this.endTag=this.endTag.replace(/(\n*$)/,""),this.after=this.after+f.$1,this.before){for(i=r="";e--;)i+="\\n?",r+="\n";n&&(i="\\n*"),this.before=this.before.replace(new f(i+"$",""),r)}if(this.after){for(i=r="";t--;)i+="\\n?",r+="\n";n&&(i="\\n*"),this.after=this.after.replace(new f(i,""),r)}},c.isVisible=function(e){return window.getComputedStyle?"none"!==window.getComputedStyle(e,null).getPropertyValue("display"):e.currentStyle?"none"!==e.currentStyle.display:void 0},c.addEvent=function(e,t,n){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,!1)},c.removeEvent=function(e,t,n){e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n,!1)},c.fixEolChars=function(e){return e=e.replace(/\r\n/g,"\n"),e=e.replace(/\r/g,"\n")},c.extendRegExp=function(e,t,n){(null===t||void 0===t)&&(t=""),(null===n||void 0===n)&&(n="");var i,r=e.toString();return r=r.replace(/\/([gim]*)$/,function(e,t){return i=t,""}),r=r.replace(/(^\/|\/$)/g,""),r=t+r+n,new f(r,i)},u.getTop=function(e,t){var n=e.offsetTop;if(!t)for(;e=e.offsetParent;)n+=e.offsetTop;return n},u.getHeight=function(e){return e.offsetHeight||e.scrollHeight},u.getWidth=function(e){return e.offsetWidth||e.scrollWidth},u.getPageSize=function(){var e,t,n,i;self.innerHeight&&self.scrollMaxY?(e=d.body.scrollWidth,t=self.innerHeight+self.scrollMaxY):d.body.scrollHeight>d.body.offsetHeight?(e=d.body.scrollWidth,t=d.body.scrollHeight):(e=d.body.offsetWidth,t=d.body.offsetHeight),self.innerHeight?(n=self.innerWidth,i=self.innerHeight):d.documentElement&&d.documentElement.clientHeight?(n=d.documentElement.clientWidth,i=d.documentElement.clientHeight):d.body&&(n=d.body.clientWidth,i=d.body.clientHeight);var r=Math.max(e,n),a=Math.max(t,i);return[r,a,n,i]},l.createBackground=function(){var e=d.createElement("div"),t=e.style;e.className="wmd-prompt-background",t.position="absolute",t.top="0",t.zIndex="1000",g.isIE?t.filter="alpha(opacity=50)":t.opacity="0.5";var n=u.getPageSize();return t.height=n[1]+"px",g.isIE?(t.left=d.documentElement.scrollLeft,t.width=d.documentElement.clientWidth):(t.left="0",t.width="100%"),d.body.appendChild(e),e},l.prompt=function(e,t,n){var i,r;void 0===t&&(t="");var a=function(e){var t=e.charCode||e.keyCode;return 27===t?(e.stopPropagation&&e.stopPropagation(),o(!0),!1):void 0},o=function(e){c.removeEvent(d.body,"keyup",a);var t=r.value;return e?t=null:(t=t.replace(/^http:\/\/(https?|ftp):\/\//,"$1://"),/^(?:https?|ftp):\/\//.test(t)||(t="http://"+t)),i.parentNode.removeChild(i),n(t),!1},s=function(){i=d.createElement("div"),i.className="wmd-prompt-dialog",i.style.padding="10px;",i.style.position="fixed",i.style.width="400px",i.style.zIndex="1001";var n=d.createElement("div");n.innerHTML=e,n.style.padding="5px",i.appendChild(n);var s=d.createElement("form"),l=s.style;s.onsubmit=function(){return o(!1)},l.padding="0",l.margin="0",l.cssFloat="left",l.width="100%",l.textAlign="center",l.position="relative",i.appendChild(s),r=d.createElement("input"),r.type="text",r.value=t,l=r.style,l.display="block",l.width="80%",l.marginLeft=l.marginRight="auto",s.appendChild(r);var f=d.createElement("input");f.type="button",f.onclick=function(){return o(!1)},f.value="OK",l=f.style,l.margin="10px",l.display="inline",l.width="7em";var h=d.createElement("input");h.type="button",h.onclick=function(){return o(!0)},h.value="Cancel",l=h.style,l.margin="10px",l.display="inline",l.width="7em",s.appendChild(f),s.appendChild(h),c.addEvent(d.body,"keyup",a),i.style.top="50%",i.style.left="50%",i.style.display="block",g.isIE_5or6&&(i.style.position="absolute",i.style.top=d.documentElement.scrollTop+200+"px",i.style.left="50%"),d.body.appendChild(i),i.style.marginTop=-(u.getHeight(i)/2)+"px",i.style.marginLeft=-(u.getWidth(i)/2)+"px"};setTimeout(function(){s();var e=t.length;if(void 0!==r.selectionStart)r.selectionStart=0,r.selectionEnd=e;else if(r.createTextRange){var n=r.createTextRange();n.collapse(!1),n.moveStart("character",-e),n.moveEnd("character",e),n.select()}r.focus()},0)};var w=o.prototype;w.prefixes="(?:\\s{4,}|\\s*>|\\s*-\\s+|\\s*\\d+\\.|=|\\+|-|_|\\*|#|\\s*\\[[^\n]]+\\]:)",w.unwrap=function(e){var t=new f("([^\\n])\\n(?!(\\n|"+this.prefixes+"))","g");e.selection=e.selection.replace(t,"$1 $2")},w.wrap=function(e,t){this.unwrap(e);var n=new f("(.{1,"+t+"})( +|$\\n?)","gm"),i=this;e.selection=e.selection.replace(n,function(e,t){return new f("^"+i.prefixes,"").test(e)?e:t+"\n"}),e.selection=e.selection.replace(/\s+$/,"")},w.doBold=function(e,t){return this.doBorI(e,t,2,this.getString("boldexample"))},w.doItalic=function(e,t){return this.doBorI(e,t,1,this.getString("italicexample"))},w.doBorI=function(e,t,n,i){e.trimWhitespace(),e.selection=e.selection.replace(/\n{2,}/g,"\n");var r=/(\**$)/.exec(e.before)[0],a=/(^\**)/.exec(e.after)[0],o=Math.min(r.length,a.length);if(o>=n&&(2!=o||1!=n))e.before=e.before.replace(f("[*]{"+n+"}$",""),""),e.after=e.after.replace(f("^[*]{"+n+"}",""),"");else if(!e.selection&&a){e.after=e.after.replace(/^([*_]*)/,""),e.before=e.before.replace(/(\s?)$/,"");var s=f.$1;e.before=e.before+a+s}else{e.selection||a||(e.selection=i);var c=1>=n?"*":"**";e.before=e.before+c,e.after=c+e.after}},w.stripLinkDefs=function(e,t){return e=e.replace(/^[ ]{0,3}\[(\d+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+|$)/gm,function(e,n,i,r,a){return t[n]=e.replace(/\s*$/,""),r?(t[n]=e.replace(/["(](.+?)[")]$/,""),r+a):""})},w.addLinkDef=function(e,t){var n=0,i={};e.before=this.stripLinkDefs(e.before,i),e.selection=this.stripLinkDefs(e.selection,i),e.after=this.stripLinkDefs(e.after,i);var r="",a=/(\[)((?:\[[^\]]*\]|[^\[\]])*)(\][ ]?(?:\n[ ]*)?\[)(\d+)(\])/g,o=function(e){n++,e=e.replace(/^[ ]{0,3}\[(\d+)\]:/,"  ["+n+"]:"),r+="\n"+e},s=function(e,t,r,c,u,l){return r=r.replace(a,s),i[u]?(o(i[u]),t+r+c+n+l):e};e.before=e.before.replace(a,s),t?o(t):e.selection=e.selection.replace(a,s);var c=n;return e.after=e.after.replace(a,s),e.after&&(e.after=e.after.replace(/\n*$/,"")),e.after||(e.selection=e.selection.replace(/\n*$/,"")),e.after+="\n\n"+r,c},w.doLinkOrImage=function(e,t,n){e.trimWhitespace(),e.findTags(/\s*!?\[/,/\][ ]?(?:\n[ ]*)?(\[.*?\])?/);var i;if(!(e.endTag.length>1&&e.startTag.length>0)){if(e.selection=e.startTag+e.selection+e.endTag,e.startTag=e.endTag="",/\n\n/.test(e.selection))return this.addLinkDef(e,null),void 0;var r=this,a=function(a){if(i.parentNode.removeChild(i),null!==a){e.selection=(" "+e.selection).replace(/([^\\](?:\\\\)*)(?=[[\]])/g,"$1\\").substr(1);var o=" [999]: "+s(a),c=r.addLinkDef(e,o);e.startTag=n?"![":"[",e.endTag="]["+c+"]",e.selection||(e.selection=n?r.getString("imagedescription"):r.getString("linkdescription"))}t()};return i=l.createBackground(),n?this.hooks.insertImageDialog(a)||l.prompt(this.getString("imagedialog"),v,a):l.prompt(this.getString("linkdialog"),b,a),!0}e.startTag=e.startTag.replace(/!?\[/,""),e.endTag="",this.addLinkDef(e,null)},w.doAutoindent=function(e){var t=this,n=!1;e.before=e.before.replace(/(\n|^)[ ]{0,3}([*+-]|\d+[.])[ \t]*\n$/,"\n\n"),e.before=e.before.replace(/(\n|^)[ ]{0,3}>[ \t]*\n$/,"\n\n"),e.before=e.before.replace(/(\n|^)[ \t]+\n$/,"\n\n"),e.selection||/^[ \t]*(?:\n|$)/.test(e.after)||(e.after=e.after.replace(/^[^\n]*/,function(t){return e.selection=t,""}),n=!0),/(\n|^)[ ]{0,3}([*+-]|\d+[.])[ \t]+.*\n$/.test(e.before)&&t.doList&&t.doList(e),/(\n|^)[ ]{0,3}>[ \t]+.*\n$/.test(e.before)&&t.doBlockquote&&t.doBlockquote(e),/(\n|^)(\t|[ ]{4,}).*\n$/.test(e.before)&&t.doCode&&t.doCode(e),n&&(e.after=e.selection+e.after,e.selection="")},w.doBlockquote=function(e){e.selection=e.selection.replace(/^(\n*)([^\r]+?)(\n*)$/,function(t,n,i,r){return e.before+=n,e.after=r+e.after,i}),e.before=e.before.replace(/(>[ \t]*)$/,function(t,n){return e.selection=n+e.selection,""}),e.selection=e.selection.replace(/^(\s|>)+$/,""),e.selection=e.selection||this.getString("quoteexample");var t,n="",i="";if(e.before){for(var r=e.before.replace(/\n$/,"").split("\n"),a=!1,o=0;o<r.length;o++){var s=!1;t=r[o],a=a&&t.length>0,/^>/.test(t)?(s=!0,!a&&t.length>1&&(a=!0)):s=/^[ \t]*$/.test(t)?!0:a,s?n+=t+"\n":(i+=n+t,n="\n")}/(^|\n)>/.test(n)||(i+=n,n="")}e.startTag=n,e.before=i,e.after&&(e.after=e.after.replace(/^\n?/,"\n")),e.after=e.after.replace(/^(((\n|^)(\n[ \t]*)*>(.+\n)*.*)+(\n[ \t]*)*)/,function(t){return e.endTag=t,""});var c=function(t){var n=t?"> ":"";e.startTag&&(e.startTag=e.startTag.replace(/\n((>|\s)*)\n$/,function(e,t){return"\n"+t.replace(/^[ ]{0,3}>?[ \t]*$/gm,n)+"\n"})),e.endTag&&(e.endTag=e.endTag.replace(/^\n((>|\s)*)\n/,function(e,t){return"\n"+t.replace(/^[ ]{0,3}>?[ \t]*$/gm,n)+"\n"}))};/^(?![ ]{0,3}>)/m.test(e.selection)?(this.wrap(e,p.lineLength-2),e.selection=e.selection.replace(/^/gm,"> "),c(!0),e.skipLines()):(e.selection=e.selection.replace(/^[ ]{0,3}> ?/gm,""),this.unwrap(e),c(!1),!/^(\n|^)[ ]{0,3}>/.test(e.selection)&&e.startTag&&(e.startTag=e.startTag.replace(/\n{0,2}$/,"\n\n")),!/(\n|^)[ ]{0,3}>.*$/.test(e.selection)&&e.endTag&&(e.endTag=e.endTag.replace(/^\n{0,2}/,"\n\n"))),e.selection=this.hooks.postBlockquoteCreation(e.selection),/\n/.test(e.selection)||(e.selection=e.selection.replace(/^(> *)/,function(t,n){return e.startTag+=n,""}))},w.doCode=function(e){var t=/\S[ ]*$/.test(e.before),n=/^[ ]*\S/.test(e.after);if(!n&&!t||/\n/.test(e.selection)){e.before=e.before.replace(/[ ]{4}$/,function(t){return e.selection=t+e.selection,""});var i=1,r=1;/(\n|^)(\t|[ ]{4,}).*\n$/.test(e.before)&&(i=0),/^\n(\t|[ ]{4,})/.test(e.after)&&(r=0),e.skipLines(i,r),e.selection?/^[ ]{0,3}\S/m.test(e.selection)?/\n/.test(e.selection)?e.selection=e.selection.replace(/^/gm,"    "):e.before+="    ":e.selection=e.selection.replace(/^(?:[ ]{4}|[ ]{0,3}\t)/gm,""):(e.startTag="    ",e.selection=this.getString("codeexample"))}else e.trimWhitespace(),e.findTags(/`/,/`/),e.startTag||e.endTag?e.endTag&&!e.startTag?(e.before+=e.endTag,e.endTag=""):e.startTag=e.endTag="":(e.startTag=e.endTag="`",e.selection||(e.selection=this.getString("codeexample")))},w.doList=function(e,t,n){var i=/(\n|^)(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*$/,r=/^\n*(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*/,a="-",o=1,s=function(){var e;return n?(e=" "+o+". ",o++):e=" "+a+" ",e},c=function(e){return void 0===n&&(n=/^\s*\d/.test(e)),e=e.replace(/^[ ]{0,3}([*+-]|\d+[.])\s/gm,function(){return s()})};if(e.findTags(/(\n|^)*[ ]{0,3}([*+-]|\d+[.])\s+/,null),!e.before||/\n$/.test(e.before)||/^\n/.test(e.startTag)||(e.before+=e.startTag,e.startTag=""),e.startTag){var u=/\d+[.]/.test(e.startTag);
if(e.startTag="",e.selection=e.selection.replace(/\n[ ]{4}/g,"\n"),this.unwrap(e),e.skipLines(),u&&(e.after=e.after.replace(r,c)),n==u)return}var l=1;e.before=e.before.replace(i,function(e){return/^\s*([*+-])/.test(e)&&(a=f.$1),l=/[^\n]\n\n[^\n]/.test(e)?1:0,c(e)}),e.selection||(e.selection=this.getString("litem"));var d=s(),h=1;e.after=e.after.replace(r,function(e){return h=/[^\n]\n\n[^\n]/.test(e)?1:0,c(e)}),e.trimWhitespace(!0),e.skipLines(l,h,!0),e.startTag=d;var g=d.replace(/./g," ");this.wrap(e,p.lineLength-g.length),e.selection=e.selection.replace(/\n/g,"\n"+g)},w.doHeading=function(e){if(e.selection=e.selection.replace(/\s+/g," "),e.selection=e.selection.replace(/(^\s+|\s+$)/g,""),!e.selection)return e.startTag="## ",e.selection=this.getString("headingexample"),e.endTag=" ##",void 0;var t=0;e.findTags(/#+[ ]*/,/[ ]*#+/),/#+/.test(e.startTag)&&(t=f.lastMatch.length),e.startTag=e.endTag="",e.findTags(null,/\s?(-+|=+)/),/=+/.test(e.endTag)&&(t=1),/-+/.test(e.endTag)&&(t=2),e.startTag=e.endTag="",e.skipLines(1,1);var n=0==t?2:t-1;if(n>0){var i=n>=2?"-":"=",r=e.selection.length;for(r>p.lineLength&&(r=p.lineLength),e.endTag="\n";r--;)e.endTag+=i}},w.doHorizontalRule=function(e){e.startTag="----------\n",e.selection="",e.skipLines(2,1,!0)}}(),function(){function e(){for(var e=0;e<b.length;e++)b[e].refreshPreview()}function t(e){var t=e.match(/^\s*>\s*!/gm);if(t&&t.length==e.split("\n").length){var n=!1;e=e.replace(/(.*) (\w)/,function(e,t,i){return n=!0,t+"\n> "+i}),n||(e=e.replace(/^(\s*>\s*)!/m,"$1&#33;"))}return e}function n(e){var t=/\<blockquote\>[\n\s]*?\<p\>[\n\s]*?(![\s\S]*?)\<\/p\>[\n\s]*?\<\/blockquote\>/g,n=/^\s*?[^\s!]/m,i=/^\s*?!/gm;return e=e.replace(t,function(e,t){return n.test(t)?e:(e=e.replace(t,t.replace(i,"")),e=e.replace("<blockquote>",'<blockquote class="spoiler">'))})}function i(e){for(var t,n=[],i=/<(a|code)[^>]*>/gi;null!=(t=i.exec(e));){n.push(t.index);var r=new RegExp("</"+t[1]+">","ig");r.lastIndex=i.lastIndex;var a=r.exec(e);if(null==a)break;n.push(r.lastIndex),i.lastIndex=r.lastIndex}return n}function r(e){if(!window.tagRendererRaw)return e;var t,n,r=StackExchange.options.site.nonAsciiTags?/\[(meta-)?tag:([a-z0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF#+.-]+)\]/gi:/\[(meta-)?tag:([a-z0-9#+.-]+)\]/gi;return e=e.replace(r,function(r,a,o,s){if(!v&&a)return r;t||(t=i(e),n=t.length);for(var c=!1,u=0;n>u&&!(t[u]>s);u++)c=!c;if(c)return r;var l=null;return v&&!a&&(l=m),tagRendererRaw(sanitizeAndSplitTags(o)[0],l)})}function a(e){var t,n,i;"undefined"==typeof x&&(x=StackExchange.options.styleCode),x&&(t=u(e),n=u(t+e),e=f(e,t,n));var i=o(e);return x&&(i=h(i,t,n)),i}function o(e){return e.replace(/<[^>]*>?/gi,s)}function s(e){return e.match(k)||e.match(S)||e.match(C)?e:""}function c(e){if(""==e)return"";var t=/<\/?\w+[^>]*(\s|$|>)/g,n=e.toLowerCase().match(t),i=(n||[]).length;if(0==i)return e;for(var r,a,o,s="<p><img><br><li><hr>",c=[],u=[],l=!1,d=0;i>d;d++)if(r=n[d].replace(/<\/?(\w+).*/,"$1"),!(c[d]||s.search("<"+r+">")>-1)){if(a=n[d],o=-1,!/^<\//.test(a))for(var f=d+1;i>f;f++)if(!c[f]&&n[f]=="</"+r+">"){o=f;break}-1==o?l=u[d]=!0:c[o]=!0}if(!l)return e;var d=0;return e=e.replace(t,function(e){var t=u[d]?"":e;return d++,t})}function u(e){var t=(e.match(/~/g)||[]).length;return new Array(t+2).join("~")}function l(e){var t=I.length;t>0&&new RegExp("^"+I[t-1]).test(e)?I[t-1]=e:I.push(e),A.trigger()}function d(e){if(/^lang-/.test(e))return e;var t="c_"+e,n=E[t];return n?n:T[t]?null:(T[t]=!0,l(e),null)}function f(e,t,n){return e=e.replace(R,function(e,n,i){return t+n+t+i}),e.replace(M,function(e,t){return n+t+n})}function h(e,t,n){var i=new RegExp(t+"([a-z0-9#+.-]+)"+t+"(\\s*?<pre)","gi");e=e.replace(i,function(e,t,n){var i=d(t);return i?n+" class='"+i+" prettyprint-override'":n});var r,a=new RegExp("("+n+"([a-z0-9#+.-]+)"+n+")|(<pre><code>)","gi");return e.replace(a,function(e,t,n){if(t)return r=n,"";if(!r)return e;var i=d(r);return i?"<pre class='"+i+" prettyprint-override'><code>":e})}function p(e){function t(){c.animate({"height":u.height()-l})}function n(e){e.is(":animated")||e.animate({"top":-15},400).animate({"top":0},400).animate({"top":-8},300).animate({"top":0},300).animate({"top":-4},200).animate({"top":0},200).animate({"top":-2},100).animate({"top":0},100).animate({"top":-1},50).animate({"top":0},50)}function i(e){if(u)return e(),void 0;if(!h){h=!0;var i=g.offset();l=i.top-$("#wmd-button-row"+p).offset().top-$("#wmd-button-row"+p).outerHeight()-5,d=$("#wmd-help-button"+p);var r=d.offset().left+d.outerWidth(),a=i.left,o=g.outerWidth()+a,s=Math.max(r,o);f={"right":r-s,"width":s-a,"top":$("#wmd-button-row"+p).outerHeight()+5},d.addClass("active-help"),c=$("<div style='clear:both' />").insertBefore(g),u=$('<div id="mdhelp'+p+'" class="mdhelp"><ul id="mdhelp-tabs'+p+'" class="mdhelp-tabs"><li /></ul></div>').find("li").addSpinner().end().css(f).insertAfter(d),t(),$.get("/posts/markdown-help",{"postfix":p}).done(function(i){u.remove(),u=$(i).insertAfter(d).css(f),$("#mdhelp-tabs"+p).delegate("li:not(:last-child)","click",function(){var e=$(this).hasClass("selected");if(u.find(".mdhelp-tab").hide(),$("#mdhelp-tabs"+p+" li").removeClass("selected"),!e){$("#"+$(this).attr("data-tab")).show(),$(this).addClass("selected");var i=$(this).attr("data-buttons");if(i)for(var r=i.split(","),a=0;a<r.length;a++)n($("#wmd-"+r[a]+"-button"+p))}t()}),h=!1,e()})}}function r(){m=!0,i(function(){d.addClass("active-help"),u.show(),t()})}function a(){m||r()}function o(){u.hide(),c.animate({"height":0}),d.removeClass("active-help")}function s(){u&&u.is(":visible")?o():r()}var c,u,l,d,f,h=!1,p=(e||{}).postfix||"",g=$("#wmd-input"+p),m=!1;this.toggle=s,this.showOnce=a}function g(e){function t(e){return"facebook.stackoverflow.com"===e?"stackoverflow.com":e}function n(e,t){var n=l[e+"|"+t];return n?n:(i(e,t),null)}function i(e,n){if(!d[e+"|"+n]&&!r(t(e))){d[e+"|"+n]=!0;var i=f[e];i||(i=f[e]=[]),i.push(n),g.trigger()}}function r(e){if(e===u)return!1;if(m["s_"+e])return!0;var t=/^meta\./.test(u);return u==="meta."+e||!t&&"meta."+u===e?!1:t&&e===StackExchange.options.networkMetaHostname?!1:u===StackExchange.options.networkMetaHostname?!1:!0}function a(e){return window.apiCallbacks[e]||(window.apiCallbacks[e]=function(t){v(t,e)}),'apiCallbacks["'+e+'"]'}function o(e,n){var i=t(e);if(i===u)return!0;var r=b[e];return r||(r=b[e]={"count":0,"ids":{}}),r.ids[n]?!0:r.count>=w?!1:(r.count++,r.ids[n]=!0,!0)}var s=/<a href="((\S+)\/q(?:uestions)?\/(\d+)(?:|\/\S*?))">\1<\/a>/g,c=window.location.hostname.toLowerCase(),u=t(c),l={},d={},f={},h="6AU78DZ)GcdjNjAszYmTLQ((",p="!6G7RPxWUNTleV",g=StackExchange.helpers.DelayedReaction(function(){var e=!1;for(var n in f)if(f.hasOwnProperty(n)){var i,r=a(n);f[n].length>30?i=f[n].splice(0,30).join(";"):(i=f[n].join(";"),delete f[n]),e=!0,$.ajax({"url":"http://api.stackexchange.com/2.0/questions/"+i+"?pagesize=30&key="+h+"&filter="+p+"&site="+t(n),"crossDomain":!0,"jsonpCallback":r,"dataType":"jsonp"});break}e&&g.trigger()},1e3,{"sliding":!0}),m={};window.apiCallbacks={};var v=function(t,n){if(t){if(t.error_message)return/^No site found/.test(t.error_message)&&(m["s_"+n]=!0),void 0;if(t.items){for(var i=t.items,r=i.length,a=0;r>a;a++){var o=i[a];l[n+"|"+o.question_id]=o.title}e&&e()}}},b={},w=/^meta\./.test(u)?40:10;return function(e){return b={},e.replace(s,function(e,t,i,r){if(i=i.toLowerCase().replace(/^http:\/\//,""),/[^a-z0-9.]/.test(i))return e;if(!o(i,r))return e;var a=n(i,r);return a?'<a href="'+t+'">'+a+"</a>":e})}}if(!StackExchange.MarkdownEditor){var m,v,b=[],w=g(e),y=$.Callbacks();StackExchange.MarkdownEditor=function(e){var i=e.postfix||"";v=StackExchange.options.site.isMetaSite,v&&(m=StackExchange.options.site.parentUrl||"//www.stackoverflow.com");var o=new Markdown.Converter,s=o.hooks;s.addNoop("preSafe"),s.chain("postConversion",w),s.chain("postConversion",function(e){return s.preSafe(e)}),s.chain("postConversion",a),s.chain("postConversion",c),s.chain("postConversion",n),s.chain("postConversion",r);var u=new p({"postfix":i}),l={"helpButton":{"handler":u.toggle}};e.noCode&&(l.strings={"code":"Preformatted text <pre><code> Ctrl-K","codeexample":"enter preformatted text here"});var d=new Markdown.Editor(o,i,l);d.hooks.chain("postBlockquoteCreation",t),StackExchange.options.disableImageUploads||d.hooks.set("insertImageDialog",StackExchange.imageUploader.uploadImageDialog),y.fire(d,e.postfix);var f=$("#wmd-preview"+i);return d.hooks.chain("onPreviewRefresh",function(){f.trigger("wmdrefresh")}),b.push(d),d.run(),e.immediatelyShowMarkdownHelp?u.showOnce(e):e.autoShowMarkdownHelp&&$("#wmd-input"+i).one("focus",function(){u.showOnce(e)}),d.disableSubmission=function(){$("#submit-button"+i).attr("disabled","disabled"),StackExchange.navPrevention.stop()},d},StackExchange.MarkdownEditor.creationCallbacks=y,StackExchange.MarkdownEditor.refreshAllPreviews=e;var x;StackExchange.MarkdownEditor.sanitizeHtml=o;var k=/^(<\/?(b|blockquote|code|del|dd|dl|dt|em|h1|h2|h3|i|kbd|li|ol|p|pre|s|sup|sub|strong|strike|ul)>|<(br|hr)\s?\/?>)$/i,S=/^(<a\shref="((https?|ftp):\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+"(\stitle="[^"<>]+")?\s?>|<\/a>)$/i,C=/^(<img\ssrc="(https?:\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+"(\swidth="\d{1,3}")?(\sheight="\d{1,3}")?(\salt="[^"<>]*")?(\stitle="[^"<>]*")?\s?\/?>)$/i;StackExchange.MarkdownEditor.balanceTags=c;var E={},T={},I=[],A=StackExchange.helpers.DelayedReaction(function(){0!=I.length&&($.ajax("/api/tags/"+encodeURIComponent(I.join(";"))+"/syntax-highlight",{"cache":!0}).done(function(e){var t=!1;for(var n in e)e.hasOwnProperty(n)&&(E["c_"+n]=e[n],t=!0);t&&(StackExchange.MarkdownEditor.refreshAllPreviews(),styleCode())}),I=[])},2e3,{"sliding":!0}),R=/<!-- language: ([a-z0-9#+\-.]+) -->(\s*?<pre>\s*?<code>)/gi,M=/<!-- language-all: ([a-z0-9#+\-.]+) -->/gi}}(),StackExchange.editor=function(){var e=function(e){e=e||{};var t,n,i=e.postfix||"",r=e.heartbeatType,a=e.bindNavPrevention,o=$("#post-form"+i),s=$("#wmd-input"+i);n=$("#title, #edit-comment, #m-address, .edit-comment"),t=n.add(".tag-editor input"),o.submit(function(){var e=!0;return n.each(function(){StackExchange.helpers.hideHelpOverlay($(this))}),e&&(StackExchange.helpers.disableSubmitButton(o),StackExchange.navPrevention.stop()),e}),$(".original-question").not(".processed").TextAreaResizer(),s.not(".processed").TextAreaResizer(),s.typeWatch({"highlight":!1,"wait":5e3,"captureLength":5,"callback":styleCode});var c=new StackExchange.MarkdownEditor(e);if(r){var u=e.discardSelector?$(e.discardSelector):null;StackExchange.cardiologist.addHeart(r,s,c,u,e.postId)}if("ask"==r||"answer"==r){var l=s.add(t),d=function(){return StackExchange.helpers.loadTicks(o),l.unbind("keydown",d),!0};l.bind("keydown",d)}if(a){var f="edit"==r||"ask"==r?s.add("#title").add("#tagnames"):s;StackExchange.navPrevention.init(f)}if(o.find(".wmd-preview").click(function(e){2!=e.which&&$(this).siblings().find("textarea").focus()}),StackExchange.helpers.bindHelpOverlayEvents(n),0==$("#ask-page-has-errors").length&&$("#title").is("input")&&$("#title").focus(),e.oncreated&&e.oncreated(c),e.discardSelector&&("ask"==r||"answer"==r||"moderatormessage"==r)){var h=$(e.discardSelector);h.click(function(e){if(e.preventDefault(),confirm("Are you sure you want to discard your draft?")){$("#title").val("").blur(),$("#question-suggestions").empty(),$("#wmd-input-42").val(""),$("#wmd-preview-42").html(""),$("#answer-from-ask").is(":visible")&&$("#answer-from-ask").is(":checked")&&$("#answer-from-ask").click();var t=$("#tagnames");return t.length>0&&t[0].func_clear&&(t[0].func_clear(),t.blur()),s.val("").blur(),c.refreshPreview(),$.post("/post/discard-draft",{"fkey":StackExchange.options.user.fkey,"postType":r},function(){$("#draft-saved").hide(),$("#draft-discarded").show();var e=null;e=function(){$("#draft-discarded").hide(),$("#title").unbind("keypress",e),s.unbind("keypress",e)},$("#title").bind("keypress",e),s.bind("keypress",e)}),h.hide(),!1}})}},t=function(t){var n=(t||{}).postfix||"",i=0!=$("#wmd-preview"+n).length&&("-42"!==n||0===$("#answer-from-ask").length)&&0===$("#show-editor-button"+n).length;i?(e(t),StackExchange.editor.finallyInit||(StackExchange.editor.finallyInit=function(){})):StackExchange.editor.finallyInit=function(){e(t)}};return{"init":e,"initIfShown":t}}(),StackExchange.cardiologist=function(){function e(e){var n="number"==typeof e?e:1e3*(v+b);h&&(n=Math.max(n,6e3-((new Date).getTime()-h))),p&&clearTimeout(p),p=setTimeout(t,n)}function t(){if(p=null,m.length||n(),!m.length)return e(),void 0;var t=m.shift();t.checkActive()?t.beat():e()}function n(){var e;m=[],l&&!l.isDisabled&&l.beatCount<30&&m.push(l);for(var t=0;t<g.length;t++)e=g[t],e!=l&&!e.isDisabled&&e.beatCount<30&&m.push(e);v=Math.max(15,Math.min(45,60/(m.length||1)))}function i(){}function r(e){var t=[];$.get("/questions/"+e,function(n){var i=$(n);if(i.find("div.answer").each(function(){var e=this.id.substring("answer-".length);0==$("#answer-"+e).length&&t.push(this.id)}),t.length>0){var r="#"+t.join(",#"),a=i.find(r),o=$("div.answer:last");0==o.length&&(o=$("#answers-header")),a.hide(),o.after(a),a.fadeIn("slow");var s=$("div.answer").length;$(".subheader h2").text(s+" Answer"+(s>1?"s":"")),StackExchange.vote.init(e),StackExchange.comments.init({"post":a})}StackExchange.notify.close(y),w=!1},"html")}function a(e,t,n,r,a){var o,s=new i;switch(s.type=e,s.jTextarea=t,s.discardDraftLink=r,e){case"ask":o=0;break;case"answer":o=$("#post-id").val()||location.href.match(/\/questions\/(\d+)/i)[1];break;case"edit":o=a||$("#post-id").val()||t.closest(".question, .answer").find(".vote input").val();var c=t.closest(".inline-post"),u=null;c.length>0&&(u=c[0].action.split("/").pop()),u||(u=$("#client-revision-guid").val()),s.revisionGuid=u;break;case"moderatormessage":o=+$("#moderator-message-to-user").attr("data-userid")}s.postId=o,s.editor=n,t.keypress(function(){s.activate()})}function o(e,t){return l&&l.checkActive()?(l.beat(t).done(e),void 0):(e(),void 0)}function s(){e(1)}function c(){w=!0}function u(){if(null==g)return!1;for(var e=0;e<g.length;e++)if(1==g[e].checkActive())return!0;return!1}var l,d,f,h,p,g=[],m=[],v=45,b=0,w=!1,y=-2,x={"ask":function(e){if(e.relatedQuestions){var t=$("#how-to-format"),n=e.relatedQuestions!=f;n&&t.hide(),t.empty().append("<h4>Similar Questions</h4>"+e.relatedQuestions),n&&showFadingHelpText(t),f=e.relatedQuestions}e.suggestedTags&&StackExchange.tagSuggestions&&StackExchange.tagSuggestions.suggest(e.suggestedTags)},"answer":function(e,t){if(e&&!w)if(e.disableEditor){var n=function(e){return"This question has been "+e.message+" - no more answers will be accepted."}({"message":e.message});StackExchange.notify.show(n,y),w=!0}else{var i=parseInt(e.message);if(i>0){var a=function(e){return 1==e.count?e.count+" new answer has been posted - "+e.startAnchor+"load new answers."+e.endAnchor:e.count+" new answers have been posted - "+e.startAnchor+"load new answers."+e.endAnchor}({"count":i,"startAnchor":'<a id="load-new-answers">',"endAnchor":"</a>"});StackExchange.notify.show(a,y),w=!0,$("#load-new-answers").click(function(){r(t.postId)})}}},"edit":function(e){if(e&&e.message){var t=StackExchange.notify.getMessageText(y);t!=$("<span />").html(e.message).text()&&(StackExchange.notify.close(y),StackExchange.notify.show(e.message,y))}},"moderatormessage":function(){}};i.prototype={"activate":function(){l=this,this.isActive||(this.isActive=!0,this.beatCount=0,g.push(this),1===g.length&&e())},"checkActive":function(){return!this.isActive||this.isDisabled?!1:this.jTextarea.closest("body").length?!0:(delete this.jTextarea,this.isDisabled=!0,!1)},"beat":function(e){var t=this,n={"type":"POST","url":"/posts/"+this.postId+"/editor-heartbeat/"+this.type,"dataType":"json","data":{}};if(e||(n.success=function(e){t.success(e)},n.error=function(){t.error()},n.complete=function(){t.complete()}),this.shouldSendDraft()){var i={"text":this.jTextarea.val()};"ask"===this.type&&(i.title=$("#title").val(),i.tagnames=$("#tagnames").val(),i.answertext=$("#wmd-input-42").val()),d&&d.heart===this&&d.title===i.title&&d.tagnames===i.tagnames&&d.text===i.text&&d.answertext===i.answertext||(n.data=i,d={"heart":this,"title":i.title,"tagnames":i.tagnames,"text":i.text,"answertext":i.answertext})}if(e&&!("text"in n.data))return $.Deferred().resolve().promise();if(this.revisionGuid&&(n.data.clientRevisionGuid=this.revisionGuid),"answer"===this.type){var r=$("#answers-header .answers-subheader h2").text().replace(/ answers?/i,"")||"0";n.data.clientCount=r}return h=(new Date).getTime(),$.ajax(n).promise()},"shouldSendDraft":function(){return"edit"!==this.type&&l===this},"success":function(e){x[this.type](e,this),e.disableEditor&&(this.editor.disableSubmission(),this.isDisabled=!0),e.draftSaved&&k(this.jTextarea,this.discardDraftLink),this.beatCount++,b=0},"error":function(){$("#draft-saved").hide(),l===this&&m.unshift(this),b=(new Date).getTime()%100/10},"complete":function(){e()}};var k=function(e,t){var n=$("#draft-saved"),i=function(){n.text("draft saved").fadeIn("fast")};n.is(":visible")?n.fadeOut("fast",i):i(),t&&t.removeClass("dno").show();var r=function(t){(115!=t.which||!t.ctrlKey||t.shiftKey||t.altKey)&&(e.unbind("keypress",r),$("#draft-saved").fadeOut("fast"))};e.bind("keypress",r),$("#draft-discarded").hide()};return{"addHeart":a,"ensureDraftSaved":o,"beatASAP":s,"notifiedOfNewAnswer":c,"isHeartBeating":u}}(),StackExchange.navPrevention=function(){var e,t,n=function(){var n=!1;return e.each(function(e){n=n||$(this).val()!==t[e]}),n},i=function(t){window.onbeforeunload=t?function(){return e&&n()?t:void 0}:null},r=function(){i("You have started writing or editing a post.")};return{"init":function(n){e=n.one("keypress",r),t=[],n.each(function(){t.push($(this).val())})},"start":function(){e&&r()},"stop":function(){e&&(e.unbind("keypress",r),i(null),e=null)},"confirm":function(t){return e&&n()?confirm(t):!0}}}(),function(e){function t(t){return a=e(t.data.el),a.blur(),s=r(t).y,o=a.height()-s,a.css("opacity",.25),e(document).mousemove(n).mouseup(i),!1}function n(e){var t=r(e).y,n=o+t;return s>=t&&(n-=5),s=t,n=Math.max(c,n),a.height(n+"px"),c>n&&i(e),!1}function i(){e(document).unbind("mousemove",n).unbind("mouseup",i),a.css("opacity",1),a.focus(),a=null,o=null,s=0}function r(e){return{"x":e.clientX+document.documentElement.scrollLeft,"y":e.clientY+document.documentElement.scrollTop}}var a,o,s=0,c=32;e.fn.TextAreaResizer=function(){return this.each(function(){a=e(this).addClass("processed"),o=null,e(this).parent().append(e('<div class="grippie"></div>').bind("mousedown",{"el":this},t));var n=e("div.grippie",e(this).parent())[0];n.style.marginRight=n.offsetWidth-e(this)[0].offsetWidth+"px"})}}(jQuery),StackExchange.imageUploader=function(){var e={};return{"uploadImageDialog":function(t,n){var i="upload-iframe-"+(new Date).getTime();"undefined"==typeof n&&(n="/upload/image");var r,a,o,s=window.FileReader&&window.FormData,c=s&&"ondrop"in window,u=s&&"onpaste"in document.body&&window.Clipboard,l="/render/image-upload?uploadUrl={0}&canDragDrop={1}&canPaste={2}".formatUnicorn(encodeURIComponent(n),c?"true":"false",u?"true":"false"),d=$('<div class="popup" id="image-upload" style="z-index:1010; width: 420px;" tabindex="-1"></div>').addClass("async-load").data("load-url",l),f=function(e){var t=e.charCode||e.keyCode;return 27===t?(h(null),!1):void 0},h=function(e){return d&&d.fadeOutAndRemove(),$("body").unbind("keyup",f),$("body").unbind("paste"),void 0!==e&&t(e),a&&a.fadeOutAndRemove(),!1},p=function(t){h();var n="/render/image-upload/preview";a=$('<div class="popup" id="image-upload" style="z-index:1010;"></div>').addClass("async-load").data("load-url",n),a.appendTo("#header").center().fadeIn("fast"),$("body").bind("keyup",f);var i=function(){a.find("#image-preview").attr("src",t),T(a),StackExchange.helpers.bindMovablePopups(),C()};a.asyncLoad({"callback":i,"cache":e})},g=function(e){e=e||window.event,x(e),r.style.backgroundColor="white";var t=e.dataTransfer,n=t.files;o=n[0];var i=new window.FileReader;return i.onloadend=m,i.readAsDataURL(o),!1},m=function(e){p(e.target.result)},v=function(e){if(e=e.originalEvent||window.event,e.clipboardData){var t=e.clipboardData.items;if(t)for(var n=0;n<t.length;n++)if(-1!==t[n].type.indexOf("image")){o=t[n].getAsFile();var i=window.URL||window.webkitURL,r=i.createObjectURL(o);p(r)}}},b=function(){return!1},w=function(){return!1},y=function(){if(E(a),window.FormData){var e=new window.FormData;e.append("uploadedImage",o),e.append("fkey",StackExchange.options.user.fkey),$.ajax({"url":n,"data":e,"cache":!1,"contentType":!1,"processData":!1,"type":"POST","success":function(e){$("#"+i).contents().find("html").html(e)}})}},x=function(e){return e.preventDefault&&e.preventDefault(),!1},k=function(){r=document.getElementById("image-upload"),c&&(r.ondrop=g,r.ondragover=w,r.ondragleave=b),u&&$("body").bind("paste",v),d.find(".popup-close").click(function(){h(null)}),d.find(":radio").change(function(){var e=d.find("#filename-input"),t=d.find("#url-wrapper");e.toggle(),t.toggle(),$("#upload-message").css({"color":"inherit","fontWeight":"inherit"}).hide().text(""),t.is(":visible")&&d.find("#url-input").focus()}),d.find("form").submit(function(){E(d);var e,t=d.find(":radio:checked").val(),n=d.find("#filename-input"),r=d.find("#url-wrapper");if("web"==t){var a=n.next();n.detach(),e=function(){n.insertBefore(a)}}else{var o=r.next();r.detach(),e=function(){r.insertBefore(o)}}return this.target=i,window.closeDialog=h,window.displayUploadError=function(t){$("#upload-message").css({"color":"red","fontWeight":"bold"}).show().text(t),e(),e=null},!0}),d.find("#filename-input").focus()},S=function(){d.asyncLoad({"callback":function(){T(d),StackExchange.helpers.bindMovablePopups(),StackExchange.helpers.bindHelpOverlayEvents($("#url-input")),k()},"cache":e})},C=function(){a.find(".popup-close").click(function(){h(null)}),$("#cancel-upload").click(function(){h(null)}),$("#confirm-upload").click(y),window.closeDialog=h,window.displayUploadError=function(e){$("#upload-message").css({"color":"red","fontWeight":"bold"}).show().text(e)}},E=function(e){var t=e.find("#upload-message");t.text(t.data("uploading-text")).addSpinner()},T=function(e){$('<iframe style="display: none;" src="about:blank" />').attr("id",i).attr("name",i).appendTo(e)};return d.appendTo("#header").center().fadeIn("fast").promise().done(S),$("body").bind("keyup",f),!0}}}(),StackExchange.postValidation=function(){function e(e,t,n){var u=e.find('input[type="submit"]:visible'),l=u.length&&u.is(":enabled");l&&u.attr("disabled",!0),i(e),r(e,t,n),o(e),s(e),c(e);var d=function(){1!=t||e.find(v).length?(a(e),l&&u.attr("disabled",!1)):setTimeout(d,250)};d()}function t(t,i,r,a,o){e(t,i,a);var s,c=function(e){if(e.success)if(o)o(e);else{var n=window.location.href.split("#")[0],a=e.redirectTo.split("#")[0];0==a.indexOf("/")&&(a=window.location.protocol+"//"+window.location.hostname+a),s=!0,window.location=e.redirectTo,n.toLowerCase()==a.toLowerCase()&&window.location.reload(!0)}else e.captchaHtml?StackExchange.captcha.init(e.captchaHtml,c):e.errors?d(e.errors,t,i,r):t.find('input[type="submit"]:visible').parent().showErrorMessage(e.message)};t.submit(function(){if(t.find("#answer-from-ask").is(":checked"))return!0;var e=t.find(b);return"[Edit removed during grace period]"==$.trim(e.val())?(f(e,["Comment reserved for system use. Please use an appropriate comment."],u()),!1):(n(),StackExchange.navPrevention&&StackExchange.navPrevention.stop(),t.find('input[type="submit"]:visible').parent().addSpinner(),StackExchange.helpers.disableSubmitButton(t),setTimeout(function(){$.ajax({"type":"POST","dataType":"json","data":t.serialize(),"url":t.attr("action"),"success":c,"error":function(){var e;switch(r){case"question":e="An error occurred submitting the question.";break;case"answer":e="An error occurred submitting the answer.";break;case"edit":e="An error occurred submitting the edit.";break;case"tags":e="An error occurred submitting the tags.";break;case"post":default:e="An error occurred submitting the post."}t.find('input[type="submit"]:visible').parent().showErrorMessage(e)},"complete":function(){StackExchange.helpers.removeSpinner(),s||StackExchange.helpers.enableSubmitButton(t)}})},0),!1)})}function n(){for(var e=0;e<x.length;e++)clearTimeout(x[e]);x=[]}function i(e){var t=e.find(g);t.length&&t.blur(function(){x.push(setTimeout(function(){var n=t.val(),i=$.trim(n);if(0==i.length)return h(e,t),void 0;var r=t.data("min-length");if(r&&i.length<r)return f(t,[function(e){return 1==e.minLength?"Title must be at least "+e.minLength+" character.":"Title must be at least "+e.minLength+" characters."}({"minLength":r})],u()),void 0;var a=t.data("max-length");return a&&i.length>a?(f(t,[function(e){return 1==e.maxLength?"Title cannot be longer than "+e.maxLength+" character.":"Title cannot be longer than "+e.maxLength+" characters."}({"maxLength":a})],u()),void 0):($.ajax({"type":"POST","url":"/posts/validate-title","data":{"title":n},"success":function(n){n.success?h(e,t):f(t,n.errors.Title,u())},"error":function(){h(e,t)}}),void 0)},k))})}function r(e,t,n){var i=e.find(m);i.length&&i.blur(function(){x.push(setTimeout(function(){var r=i.val(),a=$.trim(r);if(0==a.length)return h(e,i),void 0;if(5==t){var o=i.data("min-length");return o&&a.length<o?f(i,[function(e){return"Wiki Body must be at least "+e.minLength+" characters. You entered "+e.actual+"."}({"minLength":o,"actual":a.length})],u()):h(e,i),void 0}(1==t||2==t)&&$.ajax({"type":"POST","url":"/posts/validate-body","data":{"body":r,"oldBody":i.prop("defaultValue"),"isQuestion":1==t,"isSuggestedEdit":n},"success":function(t){t.success?h(e,i):f(i,t.errors.Body,u())},"error":function(){h(e,i)}})},k))})}function a(e){var t=e.find(v);if(t.length){var n=t.parent().find("input#tagnames");n.blur(function(){x.push(setTimeout(function(){var i=n.val(),r=$.trim(i);return 0==r.length?(h(e,t),void 0):($.ajax({"type":"POST","url":"/posts/validate-tags","data":{"tags":i,"oldTags":n.prop("defaultValue")},"success":function(n){n.success?h(e,t):f(t,n.errors.Tags,u())},"error":function(){h(e,t)}}),void 0)},k))})}}function o(e){var t=e.find(b);t.length&&t.blur(function(){x.push(setTimeout(function(){var n=t.val(),i=$.trim(n);if(0==i.length)return h(e,t),void 0;var r=t.data("min-length");if(r&&i.length<r)return f(t,[function(e){return 1==e.minLength?"Your edit summary must be at least "+e.minLength+" character.":"Your edit summary must be at least "+e.minLength+" characters."}({"minLength":r})],u()),void 0;var a=t.data("max-length");return a&&i.length>a?(f(t,[function(e){return 1==e.maxLength?"Your edit summary cannot be longer than "+e.maxLength+" character.":"Your edit summary cannot be longer than "+e.maxLength+" characters."}({"maxLength":a})],u()),void 0):(h(e,t),void 0)},k))})}function s(e){var t=e.find(w);t.length&&t.blur(function(){x.push(setTimeout(function(){var n=t.val(),i=$.trim(n);if(0==i.length)return h(e,t),void 0;var r=t.data("min-length");if(r&&i.length<r)return f(t,[function(e){return"Wiki Excerpt must be at least "+e.minLength+" characters; you entered "+e.actual+"."}({"minLength":r,"actual":i.length})],u()),void 0;var a=t.data("max-length");return a&&i.length>a?(f(t,[function(e){return"Wiki Excerpt cannot be longer than "+e.maxLength+" characters; you entered "+e.actual+"."}({"maxLength":a,"actual":i.length})],u()),void 0):(h(e,t),void 0)},k))})}function c(e){var t=e.find(y);t.length&&t.blur(function(){x.push(setTimeout(function(){var n=t.val(),i=$.trim(n);return 0==i.length?(h(e,t),void 0):/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,20}$/i.test(n)?(h(e,t),void 0):(f(t,["This email does not appear to be valid."],l()),void 0)},k))})}function u(){var e=$("#sidebar, .sidebar").first().width()||270;return{"position":{"my":"left top","at":"right center"},"css":{"max-width":e,"min-width":e},"closeOthers":!1}}function l(){var e=$("#sidebar, .sidebar").first().width()||270;return{"position":{"my":"left top","at":"right center"},"css":{"min-width":e},"closeOthers":!1}}function d(e,t,n,i){if(e){var r=function(){var n=0;f(t.find(g),e.Title,u())?n++:h(t,t.find(g)),f(t.find(m),e.Body,u())?n++:h(t,t.find(m)),f(t.find(v),e.Tags,u())?n++:h(t,t.find(v)),f(t.find(b),e.EditComment,u())?n++:h(t,t.find(b)),f(t.find(w),e.Excerpt,u())?n++:h(t,t.find(w)),f(t.find(y),e.Email,l())?n++:h(t,t.find(y));var r=t.find(".general-error"),a=e.General&&e.General.length>0;if(a||n>0){if(!r.length){var o=t.find('input[type="submit"]:visible');o.before('<div class="general-error-container"><div class="general-error"></div><br class="cbt" /></div>'),r=t.find(".general-error")}if(a)f(r,e.General,{"position":"inline","css":{"float":"left","margin-bottom":"10px"},"closeOthers":!1,"dismissable":!1});else{h(t,r);var s;switch(i){case"question":s=function(e){return 1==e.specificErrorCount?"Your question couldn't be submitted. Please see the error above.":"Your question couldn't be submitted. Please see the errors above."}({"specificErrorCount":n});break;case"answer":s=function(e){return 1==e.specificErrorCount?"Your answer couldn't be submitted. Please see the error above.":"Your answer couldn't be submitted. Please see the errors above."}({"specificErrorCount":n});break;case"edit":s=function(e){return 1==e.specificErrorCount?"Your edit couldn't be submitted. Please see the error above.":"Your edit couldn't be submitted. Please see the errors above."}({"specificErrorCount":n});break;case"tags":s=function(e){return 1==e.specificErrorCount?"Your tags couldn't be submitted. Please see the error above.":"Your tags couldn't be submitted. Please see the errors above."}({"specificErrorCount":n});break;case"post":default:s=function(e){return 1==e.specificErrorCount?"Your post couldn't be submitted. Please see the error above.":"Your post couldn't be submitted. Please see the errors above."}({"specificErrorCount":n})}r.text(s)}}else t.find(".general-error-container").remove();var c;p()&&($("#sidebar").animate({"opacity":.4},500),c=setInterval(function(){p()||($("#sidebar").animate({"opacity":1},500),clearInterval(c))},500));var d;t.find(".validation-error").each(function(){var e=$(this).offset().top;(!d||d>e)&&(d=e)});var x=function(){for(var e=0;3>e;e++)t.find(".message").animate({"left":"+=5px"},100).animate({"left":"-=5px"},100)};if(d){var k=$(".review-bar").length;d=Math.max(0,d-(k?125:30)),$("html, body").animate({"scrollTop":d},x)}else x()},a=function(){1!=n||t.find(v).length?r():setTimeout(a,250)};a()}}function f(e,t,i){var r;if(!(t&&0!=t.length&&e.length&&$("html").has(e).length))return!1;if(r=1==t.length?t[0]:"<ul><li>"+t.join("</li><li>")+"</li></ul>",r&&r.length>0){var a=e.data("error-popup");if(a&&a.is(":visible")){var o=e.data("error-message");if(o==r)return!0;a.fadeOutAndRemove()}var s=StackExchange.helpers.showMessage(e,r,i);return s.find("a").attr("target","_blank"),e.addClass("validation-error"),e.data("error-popup",s),e.data("error-message",r),s.click(n),!0}return!1}function h(e,t){if(!t||0==t.length)return!1;var n=t.data("error-popup");return n&&n.is(":visible")&&n.fadeOutAndRemove(),t.removeClass("validation-error"),t.removeData("error-popup"),t.removeData("error-message"),e.find(".validation-error").length||e.find(".general-error-container").remove(),!0}function p(){var e=!1,t=$("#sidebar, .sidebar").first();if(!t.length)return!1;var n=t.offset().left;return $(".message").each(function(){var t=$(this);return t.offset().left+t.outerWidth()>n?(e=!0,!1):void 0}),e}var g="input#title",m="textarea.wmd-input:first",v=".tag-editor",b="input[id^=edit-comment]",w="textarea#excerpt",y="input#m-address",x=[],k=250;return{"initOnBlur":e,"initOnBlurAndSubmit":t,"showErrorsAfterSubmission":d,"getSidebarPopupOptions":u}}();